* TODO Introduction [9/13]
  - [X] Describe yeast/bacterial growth
  - [X] Model organism can tell us about other species (humans)
  - [X] Yeast and humans are eukaryotes
  - [X] Growth rate as a proxy for fitness
    - [X] Explain why this is suitible for microbial species
  - [X] Describe growth mediums (spot tests and liquid cultures)
    - [X] Mention disagreement in growth estimates between growth mediums
  - [-] Introduce SGA and QFA - (can leave contrast until I have
    explained QFA in more detail)
    - [X] Solid agar; high-troughput; quantitative; can study whole genomes
    - [X] Explain how fitness of genetic strains can tell us about
      genetic interactions and drug responses.
    - [ ] Give examples of this use and emphasise benefits to human health.
    - [ ] Say that Adinall studied genes involved in telomere
      stabilitly because of their links with cancer and aging and
      this could have impacts for humans but do not go into any more
      detail about telomeres, cancer, drugs, etc., (won't have room
      and don't really care for this study).
  - [-] Describe QFA in more detail - "I study QFA data ->"
    - [X] Describe the experiment design/procedure
      - Dilute or more concentrated inoculation
    - [X] Describe the data that is produced and processing with Colonyzer
    - [X] Describe current analysis with THE LOGISTIC MODEL and QFA R
      - [X] Write the logistic model equation
      - [X] I mention MDR so explain this as well
    - [X] Contrast QFA with SGA
    - [ ] Previous results (?) and follow up (Holstein &
      Clark) - Check which results were actually followed up.
  - [-] Explain the motivation for a nutrient diffusion model and
    current support for an effect
    - [X] At the same time, introduce P15 and the Stripes and Filled
      plates but wait until the methods to describe in these
      experiments in more detail.
    - [ ] Briefly mention alternative hypotheses (e.g. singal,
      metabolism) or wait until discussion? I will mention metabolism
      when I explain the approximations of the competition model. I
      think that I should probably mention signal and metabolism here
      if I have room.
  - [X] Describe previous attempts to correct for competition and how
    our approach differs
  - [X] Describe previous attempts to model diffusion (Diffusion
    equation model of Reo and Korolev 2014)
    - I am planning to talk about this in the discussion so could
      introduce here and also explain why we need a less detailed
      model (limits of computational power).
  - [-] Introduce the Competition model
    - [X] Mass action kinetics and network diffusion
    - [X] Reaction and rate equations
    - [X] No numerical solution
    - [X] Cells observed; nutrients hidden
    - [X] Explain the plate and culture level parameters.
    - [X] Explain that there are fewer parameters than in the logistic
      model.
    - [X] Explain what is measureable and what we must infer. kn? C_0
      often below detectable level in QFA - write here or elsewhere?
      We explain how we infer N_0 when we talk about initial guessing.
    - [X] Justify approximations
      - [X] Mass action kinetics
      - [X] Network diffusion
      - [X] Deterministic not stochastic
      - [X] All nutrients are converted to cells
	- Methods: Implies all cultures starting with the same amount of
          nutrients end with the same amount of cells. ->
          Mention metabolism
    - [ ] Reduces to the logistic equivalent model in the independent limit
      - [ ] Can be seen as a correction for nutrient diffusion
      - [ ] Conversion equations (Not planning to inculude the full
        derivation - Link to Conor's blog?)
      - [ ] With same plate level parameters b rank is equivalent to r
        rank (also MDR and MDR*MDP) and K is constant.
  - [X] Briefly explain what we plan to do with the model
    - Fit to data to try to estimate growth parameters more reliably
  - [X] Short summary
    - More reliable measurement of growth parameters ->
    - More reliable fitness estimates ->
    - Better prediction of genetic interaction or drug response

I could also say - We hope that a model could be used to
compare/improve experimental design by simulation of
e.g. randomisation / SGA v QFA and dilute vs concentrated. I could
just say this in one line but I imagine that the above will already
take a fair amount of space and we haven't found that yet. Perhaps at
the end of the discussion.

* Methods

** TODO Tools, solving, and fitting [0/6]
  - [ ] I wrote the code in python
  - [ ] Data analysed using Colonyzer (Python)
  - [ ] Solving
    - [ ] scipy.odeint -> optimized by vectorizing and using numpy
      - [ ] atol=1.49012e-8, rtol=1.49012e-8, mxhnil=0
    - [ ] libroadrunner
    - [ ] Empties
    - [ ] Two N_0 model
    - [ ]
  - [ ] Writing models using libSBML
  - [ ] SBML and reproducibility - spit out
  - [ ] Fitting the Competition Model
    - [ ] SciPy's scipy.optimize.minimize (optimization and rootfinding package)
    - [ ] maximum likelihood
    - [ ] QFA R package for logistic model
    - [ ] Should I talk about the Development Process? (i.e. use of
      simulations and zones; determining tolerances)

** TODO Tools, solving, and fitting [0/7]
  - [ ] I wrote the code in python
  - [ ] Data analysed using Colonyzer (Python)
  - [-] Solving
    - [ ] scipy.odeint -> optimized by vectorizing and using numpy
      - [ ] atol=1.49012e-8, rtol=1.49012e-8, mxhnil=0
    - [X] libroadrunner
    - [X] must write models in SBML (libSBML) and, unlike odeint,
      simulations only produce values at constant timeintervals.
      - Cell observations from QFA are not taken at constant time
        intervals. When fitting the competition model to data,
        evaluations of the objective function require timepoints to be
        the same for observed and simulated cell density. At first, I
        dealt with this issue by simulating between adjacent
        timepoints using repeated function calls to produce simulated
        species amounts at the observed times. I used this method of
        solving to fit P15 QFA data which has cell density observation
        at 10 timepoints. A second set of QFA data from the (Stripes
        and Filled plates experiment) has \(\sim\)50 timepoints per
        plate. Solving between timepoints was therefore about five
        times slower. Instead, I made a 5th order spline (SciPy) of
        cell density timecourses and took 15 evenly spaced cell
        density datapoints from the spline. The spline used smoothing
        s=1 and timepoints ranged from time zero to the time of the
        final cell observation in the raw data.
  - [ ] SBML and reproducibility - spit out models with estimated
    parameters - mentioned in short intro.
  - [-] Fitting the Competition Model
    - [ ] SciPy's scipy.optimize.minimize (optimization and rootfinding package)
      - [ ] Constrained minimization algorithm L-BFGS-B
    - [X] Given a model and data, I made maximum likelihood estimates
      of parameters using a normal model of measurement error.
    - [X] Stopping criteria
      - Give tollerances - With these tollerances I could recover the
        parameters of simulated data sets (both with and without a
        small amount of simulated noise) with high precision.
    - [X] How did I set bounds?
      - [X] So that parameters did not hit them
      - [X] Table
    - [X] C_0 scaling
    - [ ] Two N_0 BC conditions: Cultures at the edge of a plate have an
      advantage because they have access to a greater area of
      nutrients which could diffuse from outside of the array.
      - Moved to Intro (correcting for competitoin): (Data from these
        cultures is noisey due to reflections from plate edges. This
        is only partially corrected for by Colonyzer (ref) and as a
        result data from edge cultures is useually discarded. Addniall
        et al grow the a repeats of the same culture in edge
        locations, rather than leaving them empty, because of concerns
        about competition.)
      - I correct for this (in the competition model) using a new
        parameter (\N^{e}_{t_{0}}\) for the initial amount of
        nutrients in edge cultures. In rate equations involving edge
        cultures I convert this amount to a nutrient density by
        scaling \(N_{i}\) for each culture by the ratio
        \(N^{i}_{t_{0}}/N^{e}_{t_{0}}\) where \(N^{i}_{t_{0}}\) is the
        amount of nutrients in internal cultures (which have reaction
        volume one).
      - The physical interpretation of this correction is
        that edge cultures have an extra supply of nutrients which can
        diffuse instantly into the reaction volume.
      - I improved the error in cell density estimates for cultures
        one row or column inside the edge using the method and this
        resulted in better fits to internal cultures overall.
      - An alternative model could
        have added nutrient containing volumes (essentially empty
        cultures) outside of edge cultures with an extra parameter for
        their size and included theses in the network diffusion model
        with the same \(kn\). As this is just a correction and cell
        density observations from these cultures are very noisy, and
        these cultures are dominated by noise.
      - When fitting the competition model, it would be better if
        these cultures were left empty to remove noise in cell density
        observations.
      - I evaluated both edge cultures and internals in the objective
        function when fitting data. I selected between different fits
        to the same data the objective function for only the internal
        cultures.
      - [ ] Could not use rules to set bound NE_0 > N_0 using L-BFGS-B
        algorithm
    - [X] Empties
      - Set b = 0
      - Remove from objective fn
  - [ ] Fitting the logistic model
    - [ ] QFA R package for logistic model
    - [ ] - Contains heuristic checks for slow growing cultures and is
      currently used in QFA.
    - [ ] I did not have heuristic checks but did use a plate level
      C_0. I did not have time to write heuristic checks and wanted
      to compare to existing QFA fitting.
    - [ ] QFA R logistic fits do not set a plate level C_0.
  - [ ] Should I talk about the Development Process? (i.e. use of
    simulations and zones; determining tolerances) Probably won't
    have room.

** TODO Parameter Conversion [9/9]  # could go in or after fitting
  - [X] When kn = 0 reduces to logistic model with same solution
  - [X] Can equate models
  - [X] Conversion equation
  - [X] Mass action logistic assumes all nutrients go to cells and
    needs culture level N_0 to be fit.
  - [X] Can be seen as a correction to the logistic model
  - [X] Correction Figure
  - [X] We can convert between models to compare fitness estimates
    directly.
  - [X] b rank is proportional to r MDR and MDP
  - [X] b as a fitness estimate

** TODO Initail Guess [0/4]
  # I was debating putting the imaginary neighbour model in the
  # introduction or splitting the model and fitting between the
  # introduction and methods. I now think that this should all go in
  # the methods. Been as this is a masters disertation I think it
  # should be alright to have a couple of figures in the methods.
  - [ ] N_0 can be inferred from final cell amounts
    - [ ] Assumes reactions are nearly complete and no metabolism
    - [ ] Equation for two N_0 model
  - [ ] Explain the Imaginary neighbour model
    - [ ] Include a schematic
    - [ ] I have come up with a model for quickly fitting individual
      cultures to get appoximate estimates of b.
    - [ ] It is based on the competition model we already have.
    - [ ] We fit cell data for each culture individually
      - Solve using scipy.odeint
      - Fit using scipy.optimize.minimize and least squares
    - [ ] Places imaginary fast growing and empty cultures next to the
      culture of interest
    - [ ] We use the same number, n, of each of these. This could be
      eight in total to represent, for instance, 4 fast growing
      neighbours or 4 slow growing neighbours.
    - [ ] The value of n to use can be determined by the ratio of
      final cell amount to initial nutrient amount.
    - [ ] Fix N_0 and the growth constants of both neighbours. We have
      to use a grid of fixed C_0 values and take the best fit.
    - [ ] Allow k1, k2, and b to vary. b is the growth constant for
      the culture of interest.
    - [ ] We can also try different values of b_fast for fits of each
      culture to approximate different neighbour configurations.
    - [ ] Main difference is in having two kn's (k1 and k2) which we
      allow to vary freely.
  - [ ] Guessing k_n from b distiribution
    - [ ] I have a plot which demonstrates this which can go here or
      in the results. I think that it would be clearer to put it here.
  - [ ] Performance of imaginary neighbour guessing (plot of fit) can
    wait until the results.
** TODO Initial guess tl;dr [0/1]
  - [ ] Initial guess
    - [ ] Guessing N_0 and NE_0
    - [ ] Imaginary neighbour model - (scipy.odeint, scipy.optimize.minimize)
    - [ ] Guessing k_n from b distiributio
** TODO Development of a genetic algorithm [0/1]
  - [ ] Developing a genetic algorithm with inspyred
    - [ ] Heirarchical plate level and
    - [ ] Multiprocessing
** TODO Model comparison using a single QFA plate [0/1]
  - [ ] P15 [0/3]
    - [ ] Describe data
    - [ ] Describe fitting and analysis
    - [ ] Describe validation spot test data here?
** TODO Cross-plate calibration and validation [0/1]
  - [ ] Stripes and Filled Plates [0/2]
    - [ ] Describe data
    - [ ] Describe fitting and analysis

- Note about availibility? This is already in the abstract

Details to add
- pandas parser
- empties
- edges
- C_0 scaling
- Bounds: Constrained minimization algorithm L-BFGS-B algorithm
  - [R128] (1, 2) Byrd, R H and P Lu and J. Nocedal. 1995. A Limited
    Memory Algorithm for Bound Constrained Optimization. SIAM Journal
    on Scientific and Statistical Computing 16 (5): 1190-1208.
  - [R129] (1, 2) Zhu, C and R H Byrd and J Nocedal. 1997. L-BFGS-B:
    Algorithm 778: L-BFGS-B, FORTRAN routines for large scale bound
    constrained optimization. ACM Transactions on Mathematical
    Software 23 (4): 550-560.
- stopping criteria
- Two N_0 model
- objective function least squares
- select just the internals
- yzer
- Splining for Stripes and Filled plates
- Can also solve SBML in Copasi

* TODO Results [0/0]
* TODO Discussion [0/0]
* TODO Conclusion [0/0]
* TODO Acknowlegements [0/6]
  # How do I go about acknowledge people involved in the work? / What do I need to do?
  - [ ] Conor - Coming up with the model and idea for the project. Collaborated throughout.
    - Should I reference some of your blog posts?
  - [ ] Paolo - Suggested to use roadrunner for instance
  - [ ] Helena - I wish to talk about her project to discuss issues
    with C_0
  - [ ] Addinall - P15
  - [ ] Who? - Stripes and Filled
  - [ ] David - Validation spot test data
